{
  "cases": [
    {
      "name": "write-direct",
      "request": {
        "request_id": "cp3-direct-write-1",
        "session_id": "cp3-direct",
        "tool_name": "write",
        "args": {
          "path": "direct.txt",
          "content": "alpha\nline2\n"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed"
      }
    },
    {
      "name": "read-direct",
      "request": {
        "request_id": "cp3-direct-read-1",
        "session_id": "cp3-direct",
        "tool_name": "read",
        "args": {
          "path": "direct.txt"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "alpha"
      }
    },
    {
      "name": "edit-direct",
      "request": {
        "request_id": "cp3-direct-edit-1",
        "session_id": "cp3-direct",
        "tool_name": "edit",
        "args": {
          "path": "direct.txt",
          "oldText": "alpha",
          "newText": "beta"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed"
      }
    },
    {
      "name": "apply-patch-direct",
      "request": {
        "request_id": "cp3-direct-patch-1",
        "session_id": "cp3-direct",
        "tool_name": "apply_patch",
        "args": {
          "input": "*** Begin Patch\n*** Update File: direct.txt\n@@\n-beta\n+gamma\n*** End Patch"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "direct.txt"
      }
    },
    {
      "name": "read-direct-after-patch",
      "request": {
        "request_id": "cp3-direct-read-2",
        "session_id": "cp3-direct",
        "tool_name": "read",
        "args": {
          "path": "direct.txt"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "gamma"
      }
    },
    {
      "name": "write-sandbox",
      "request": {
        "request_id": "cp3-sandbox-write-1",
        "session_id": "cp3-sandbox",
        "tool_name": "write",
        "args": {
          "path": "sandbox.txt",
          "content": "sandbox-data"
        },
        "sandboxed": true
      },
      "expect": {
        "ok": true,
        "status": "completed"
      }
    },
    {
      "name": "read-sandbox",
      "request": {
        "request_id": "cp3-sandbox-read-1",
        "session_id": "cp3-sandbox",
        "tool_name": "read",
        "args": {
          "path": "sandbox.txt"
        },
        "sandboxed": true
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "sandbox-data"
      }
    },
    {
      "name": "sandbox-path-escape-denied",
      "request": {
        "request_id": "cp3-sandbox-escape-1",
        "session_id": "cp3-sandbox",
        "tool_name": "read",
        "args": {
          "path": "../escape.txt"
        },
        "sandboxed": true
      },
      "expect": {
        "ok": false,
        "errorCode": "path_outside_root"
      }
    },
    {
      "name": "exec-direct",
      "request": {
        "request_id": "cp3-exec-direct-1",
        "session_id": "cp3-exec",
        "tool_name": "exec",
        "args": {
          "command": "echo cp3-exec"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "contains": "cp3-exec"
      }
    },
    {
      "name": "gateway-status",
      "request": {
        "request_id": "cp3-gateway-status-1",
        "session_id": "cp3-gateway",
        "tool_name": "gateway",
        "args": {
          "action": "status"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "capabilities"
      }
    },
    {
      "name": "sessions-send",
      "request": {
        "request_id": "cp3-sessions-send-1",
        "session_id": "cp3-thread-1",
        "tool_name": "sessions",
        "args": {
          "action": "send",
          "message": "hello from sessions"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "cp3-thread-1"
      }
    },
    {
      "name": "sessions-history",
      "request": {
        "request_id": "cp3-sessions-history-1",
        "session_id": "cp3-thread-1",
        "tool_name": "sessions",
        "args": {
          "action": "history"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "hello from sessions"
      }
    },
    {
      "name": "message-default-send",
      "request": {
        "request_id": "cp3-message-send-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "text": "hello from message tool"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "cp3-thread-2"
      }
    },
    {
      "name": "message-react",
      "request": {
        "request_id": "cp3-message-react-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "react",
          "emoji": "✅"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "reactionCount"
      }
    },
    {
      "name": "message-reactions",
      "request": {
        "request_id": "cp3-message-reactions-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "reactions"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "✅"
      }
    },
    {
      "name": "message-edit",
      "request": {
        "request_id": "cp3-message-edit-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "edit",
          "message": "hello from message tool edited"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "editedAt"
      }
    },
    {
      "name": "message-read",
      "request": {
        "request_id": "cp3-message-read-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "read",
          "limit": 5
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "hello from message tool edited"
      }
    },
    {
      "name": "message-permissions",
      "request": {
        "request_id": "cp3-message-permissions-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "permissions"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "threadCreate"
      }
    },
    {
      "name": "message-thread-create",
      "request": {
        "request_id": "cp3-message-thread-create-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "thread-create",
          "threadName": "ops-thread"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "ops-thread"
      }
    },
    {
      "name": "message-thread-reply",
      "request": {
        "request_id": "cp3-message-thread-reply-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "thread-reply",
          "message": "threaded from corpus"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "threaded from corpus"
      }
    },
    {
      "name": "message-thread-list",
      "request": {
        "request_id": "cp3-message-thread-list-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "thread-list"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "ops-thread"
      }
    },
    {
      "name": "message-channel-info",
      "request": {
        "request_id": "cp3-message-channel-info-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "channel-info",
          "target": "channel:123"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "runtime-channel"
      }
    },
    {
      "name": "message-channel-list",
      "request": {
        "request_id": "cp3-message-channel-list-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "channel-list",
          "guildId": "guild-1"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"count\":2"
      }
    },
    {
      "name": "message-role-add",
      "request": {
        "request_id": "cp3-message-role-add-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "role-add",
          "guildId": "guild-1",
          "userId": "user-1",
          "roleId": "role-ops"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"applied\":true"
      }
    },
    {
      "name": "message-member-info",
      "request": {
        "request_id": "cp3-message-member-info-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "member-info",
          "guildId": "guild-1",
          "userId": "user-1"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "role-ops"
      }
    },
    {
      "name": "message-event-create",
      "request": {
        "request_id": "cp3-message-event-create-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "event-create",
          "guildId": "guild-1",
          "eventName": "Release Window",
          "startTime": "2026-02-21T20:00:00Z"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "Release Window"
      }
    },
    {
      "name": "message-event-list",
      "request": {
        "request_id": "cp3-message-event-list-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "event-list",
          "guildId": "guild-1"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"count\":1"
      }
    },
    {
      "name": "message-timeout",
      "request": {
        "request_id": "cp3-message-timeout-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "timeout",
          "guildId": "guild-1",
          "userId": "user-1",
          "durationMin": 30
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"applied\":true"
      }
    },
    {
      "name": "message-kick",
      "request": {
        "request_id": "cp3-message-kick-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "kick",
          "guildId": "guild-1",
          "userId": "user-1"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"action\":\"kick\""
      }
    },
    {
      "name": "message-ban",
      "request": {
        "request_id": "cp3-message-ban-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "ban",
          "guildId": "guild-1",
          "userId": "user-1",
          "deleteDays": 2
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"action\":\"ban\""
      }
    },
    {
      "name": "message-role-remove",
      "request": {
        "request_id": "cp3-message-role-remove-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "role-remove",
          "guildId": "guild-1",
          "userId": "user-1",
          "roleId": "role-ops"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"applied\":true"
      }
    },
    {
      "name": "message-pin",
      "request": {
        "request_id": "cp3-message-pin-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "pin"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"pinned\":true"
      }
    },
    {
      "name": "message-pins",
      "request": {
        "request_id": "cp3-message-pins-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "pins"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"count\":1"
      }
    },
    {
      "name": "message-unpin",
      "request": {
        "request_id": "cp3-message-unpin-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "unpin"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"unpinned\":true"
      }
    },
    {
      "name": "message-delete",
      "request": {
        "request_id": "cp3-message-delete-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "delete"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"deleted\":true"
      }
    },
    {
      "name": "message-poll",
      "request": {
        "request_id": "cp3-message-poll-1",
        "session_id": "cp3-thread-2",
        "tool_name": "message",
        "args": {
          "action": "poll",
          "question": "Lunch?",
          "options": [
            "Pizza",
            "Sushi"
          ]
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "\"poll\""
      }
    },
    {
      "name": "browser-open",
      "request": {
        "request_id": "cp3-browser-open-1",
        "session_id": "cp3-browser",
        "tool_name": "browser",
        "args": {
          "action": "open",
          "url": "https://example.com"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "browser.proxy"
      }
    },
    {
      "name": "canvas-present",
      "request": {
        "request_id": "cp3-canvas-present-1",
        "session_id": "cp3-canvas",
        "tool_name": "canvas",
        "args": {
          "action": "present",
          "nodeId": "cp3-node-a",
          "view": "default"
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "canvas.present"
      }
    },
    {
      "name": "nodes-location-invoke",
      "request": {
        "request_id": "cp3-nodes-location-1",
        "session_id": "cp3-node",
        "tool_name": "nodes",
        "args": {
          "action": "invoke",
          "nodeId": "cp3-node-a",
          "command": "location.get",
          "params": {}
        },
        "sandboxed": false
      },
      "expect": {
        "ok": true,
        "status": "completed",
        "contains": "location.get"
      }
    }
  ]
}
